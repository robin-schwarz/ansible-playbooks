---
hosts: proxmox
  - name: Create a Proxmox VM
    gather_facts: yes
    proxmox_kvm:
    api_user: "{{ proxmox_api_user }}"
    api_password: "{{ proxmox_api_password }}"
    api_host: "{{ proxmox_api_host }}"
    api_port: 8006
    vmid: 104 # ID for the new VM
    node: "{{ proxmox_vm_node }}"
    name: 'ubuntu-new'
    cores: 2
    memory: 4096
    disks:
      - size: 32
        storage: local-lvm # Storage pool for the disk
        template: 'ubuntu'
        state: present
